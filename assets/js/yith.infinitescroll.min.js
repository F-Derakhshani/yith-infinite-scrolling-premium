/**
 * yith.infinitescroll.js
 *
 * @author Your Inspiration Themes
 * @package YITH Infinite Scrolling
 * @version 1.0.0
 */
!function(a,b,c){"use strict";a.yit_infinitescroll=function(d){var o,e=a.extend({nextSelector:"",navSelector:"",itemSelector:"",contentSelector:"",eventType:"scroll",presetLoader:"",customLoader:"",buttonLabel:"",buttonClass:"",loadEffect:"fadeIn"},d),f="undefined"!=typeof yith_infs_script&&yith_infs_script.shop,g="undefined"!=typeof yith_infs_script&&yith_infs_script.block_loader,h=!1,i=!1,j=!1,k=!1,l=a(e.nextSelector).attr("href"),m=[],n=[],p=function(d,e){b.location.href!=d&&(b.history.replaceState({url:""+d},"Title",d),e&&(c.title=e),a(c).trigger("yith_infs_url_changed",[d,e]))};if("pagination"!=e.eventType&&a(e.navSelector).hide(),f)var q=a(e.itemSelector).first(),r=q.nextUntil(".first",e.itemSelector).length+1;var s=function(){j&&a(e.navSelector).after('<div class="yith-infs-loader">'+j+"</div>"),h=!0,l=decodeURIComponent(l),a.ajax({url:l,dataType:"html",cache:yith_infs_script.use_cache,success:function(d){o=a(e.itemSelector).last();var g=a(d),j=g.find(e.contentSelector),k=g.find(e.itemSelector),q=g.find(e.navSelector),s=g.find(e.nextSelector),u=l;if(s.length?l=s.attr("href"):(i=!0,a(c).trigger("yith-infs-scroll-finished")),f&&!o.hasClass("last")&&"pagination"!=e.eventType&&t(o,r,k),"pagination"!=e.eventType?o.after(k):(a(e.contentSelector).replaceWith(j),a(e.navSelector).replaceWith(q),a(b).scrollTop(a(e.contentSelector).offset().top)),a(".yith-infs-loader").remove(),a(c).trigger("yith_infs_adding_elem",[k,u]),k.addClass("yith-infs-animated"),k.addClass(e.loadEffect),yith_infs_script.change_url){var v=g.filter("title").length?g.filter("title").text():"";"pagination"!=e.eventType&&(m.length||m.push([b.location.href,c.title]),m.push([u,v]),n.push(o)),p(u,v)}setTimeout(function(){h=!1,k.removeClass("yith-infs-animated"),k.removeClass(e.loadEffect),a(c).trigger("yith_infs_added_elem",[k,u])},1e3)}})},t=function(b,c,d){var f=c-b.prevUntil(".last",e.itemSelector).length,g=0;d.each(function(){var b=a(this);g++,b.removeClass("first"),b.removeClass("last"),(g-f)%c==0?b.addClass("first"):(g-(f-1))%c==0&&b.addClass("last")})};if("scroll"==e.eventType){var u=""==e.customLoader?e.presetLoader:e.customLoader;j='<img src="'+u+'">',a(b).on("scroll touchstart",function(){a(this).trigger("yith_infs_start")}),a(b).on("yith_infs_start",function(){var b=a(this),c=a(e.itemSelector).last();void 0!==c&&!h&&!i&&b.scrollTop()+b.height()>=c.offset().top+c.height()&&s()})}else"button"==e.eventType?(k='<div class="yith-infs-button-wrapper"><button id="yith-infs-button" class="'+e.buttonClass+'">'+e.buttonLabel+"</button></div>",a(e.navSelector).after(k),a(c).on("yith-infs-scroll-finished",function(){a(".yith-infs-button-wrapper").remove()}),a("#yith-infs-button").off("click").on("click",function(){var b=a(this);h||(g&&b.block({message:null,overlayCSS:{background:"#fff url("+g+") no-repeat center",opacity:.5,cursor:"none"}}),s()),a(c).on("yith_infs_adding_elem",function(){g&&b.unblock()})})):"pagination"==e.eventType&&a(c).off("click",e.navSelector+" a").on("click",e.navSelector+" a",function(b){b.preventDefault(),l=a(this).attr("href"),g&&a(e.navSelector).block({message:null,overlayCSS:{background:"#fff url("+g+") no-repeat center",opacity:.5,cursor:"none"}}),s()});var v;a(b).on("scroll touchstart",function(c){var f,g,h,d=a(b),e=d.scrollTop()+d.height();void 0!==o&&m.length&&(f=n.indexOf(o),h=o.offset().top+o.height(),e<v?e<=h&&(g=f?f-1:f,o=n[g],p(m[f][0],m[f][1])):e>h+250&&(f+1<n.length&&(o=n[f+1]),p(m[f+1][0],m[f+1][1])),v=e)})}}(jQuery,window,document);